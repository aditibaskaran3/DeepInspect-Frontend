<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DeepInspect - Tunnel Health Monitor</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css">
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: linear-gradient(135deg, #1e3a8a 0%, #1e40af 100%);
            min-height: 100vh;
            margin: 0;
            padding: 0;
        }
        
        .gradient-bg {
            background: linear-gradient(135deg, #1e3a8a 0%, #1e40af 100%);
        }
        
        .card-shadow {
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
            transition: all 0.3s ease;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(59, 130, 246, 0.4);
        }
        
        .sidebar {
            background: linear-gradient(180deg, #1e3a8a 0%, #1e40af 100%);
            box-shadow: 4px 0 15px rgba(0, 0, 0, 0.1);
        }
        
        .chart-container {
            height: 300px;
            width: 100%;
            position: relative;
        }
        
        .notification-badge {
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        
        .emergency-alert {
            animation: blink 1s infinite;
        }
        
        @keyframes blink {
            0%, 50% { background-color: #ef4444; }
            51%, 100% { background-color: #dc2626; }
        }
        
        .upload-zone {
            border: 2px dashed #3b82f6;
            transition: all 0.3s ease;
        }
        
        .upload-zone:hover {
            border-color: #2563eb;
            background-color: rgba(59, 130, 246, 0.05);
        }
        
        .loading-spinner {
            border: 4px solid #f3f4f6;
            border-top: 4px solid #3b82f6;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* Print styles for PDF export */
        @media print {
            body { background: white !important; }
            .no-print { display: none !important; }
            .sidebar { position: static !important; width: 100% !important; }
            .ml-64 { margin-left: 0 !important; }
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // Mock Firebase Auth
        const mockAuth = {
            currentUser: null,
            signInWithEmailAndPassword: async (email, password) => {
                // Mock authentication logic
                const user = { uid: '123', email, role: email.includes('admin') ? 'Admin' : 'Inspector' };
                mockAuth.currentUser = user;
                return { user };
            },
            createUserWithEmailAndPassword: async (email, password) => {
                const user = { uid: '123', email, role: 'Inspector' };
                mockAuth.currentUser = user;
                return { user };
            },
            signOut: async () => {
                mockAuth.currentUser = null;
            }
        };

        // Mock Firestore
        const mockFirestore = {
            collection: (name) => ({
                add: async (data) => ({ id: Date.now().toString(), ...data }),
                get: async () => ({
                    docs: [
                        { id: '1', data: () => ({ defectType: 'Crack', severity: 'High', date: '2024-01-15', tunnel: 'Tunnel A' }) },
                        { id: '2', data: () => ({ defectType: 'Water Seepage', severity: 'Medium', date: '2024-01-20', tunnel: 'Tunnel B' }) },
                        { id: '3', data: () => ({ defectType: 'Structural Damage', severity: 'Critical', date: '2024-01-25', tunnel: 'Tunnel C' }) }
                    ]
                }),
                doc: (id) => ({
                    update: async (data) => data,
                    delete: async () => true
                })
            })
        };

        // Authentication Component
        function AuthComponent({ onLogin }) {
            const [isLogin, setIsLogin] = useState(true);
            const [email, setEmail] = useState('');
            const [password, setPassword] = useState('');
            const [role, setRole] = useState('Inspector');
            const [loading, setLoading] = useState(false);

            const handleSubmit = async (e) => {
                e.preventDefault();
                setLoading(true);
                try {
                    const result = isLogin 
                        ? await mockAuth.signInWithEmailAndPassword(email, password)
                        : await mockAuth.createUserWithEmailAndPassword(email, password);
                    
                    result.user.role = email.includes('admin') ? 'Admin' : role;
                    onLogin(result.user);
                } catch (error) {
                    console.error('Auth error:', error);
                } finally {
                    setLoading(false);
                }
            };

            return (
                <div className="min-h-screen flex items-center justify-center gradient-bg p-4">
                    <div className="bg-white rounded-lg card-shadow p-8 w-full max-w-md">
                        <div className="text-center mb-8">
                            <h1 className="text-3xl font-bold text-blue-900 mb-2">DeepInspect</h1>
                            <p className="text-gray-600">Tunnel Health Monitor</p>
                        </div>
                        
                        <form onSubmit={handleSubmit} className="space-y-6">
                            <div>
                                <label className="block text-sm font-medium text-gray-700 mb-2">Email</label>
                                <input
                                    type="email"
                                    value={email}
                                    onChange={(e) => setEmail(e.target.value)}
                                    className="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                                    required
                                />
                            </div>
                            
                            <div>
                                <label className="block text-sm font-medium text-gray-700 mb-2">Password</label>
                                <input
                                    type="password"
                                    value={password}
                                    onChange={(e) => setPassword(e.target.value)}
                                    className="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                                    required
                                />
                            </div>
                            
                            {!isLogin && (
                                <div>
                                    <label className="block text-sm font-medium text-gray-700 mb-2">Role</label>
                                    <select
                                        value={role}
                                        onChange={(e) => setRole(e.target.value)}
                                        className="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                                    >
                                        <option value="Inspector">Inspector</option>
                                        <option value="Admin">Administrator</option>
                                    </select>
                                </div>
                            )}
                            
                            <button
                                type="submit"
                                disabled={loading}
                                className="w-full btn-primary text-white py-2 px-4 rounded-md font-medium disabled:opacity-50"
                            >
                                {loading ? (
                                    <div className="flex items-center justify-center">
                                        <div className="loading-spinner mr-2" style={{width: '20px', height: '20px'}}></div>
                                        Processing...
                                    </div>
                                ) : (
                                    isLogin ? 'Sign In' : 'Sign Up'
                                )}
                            </button>
                        </form>
                        
                        <div className="mt-6 text-center">
                            <button
                                onClick={() => setIsLogin(!isLogin)}
                                className="text-blue-600 hover:text-blue-800 text-sm"
                            >
                                {isLogin ? "Don't have an account? Sign up" : "Already have an account? Sign in"}
                            </button>
                        </div>
                    </div>
                </div>
            );
        }

        // Sidebar Component
        function Sidebar({ user, currentView, setCurrentView, onLogout }) {
            const menuItems = user.role === 'Admin' ? [
                { id: 'dashboard', icon: 'fas fa-tachometer-alt', label: 'Dashboard' },
                { id: 'inspections', icon: 'fas fa-search', label: 'All Inspections' },
                { id: 'users', icon: 'fas fa-users', label: 'Manage Users' },
                { id: 'alerts', icon: 'fas fa-exclamation-triangle', label: 'Emergency Alerts' },
                { id: 'reports', icon: 'fas fa-chart-bar', label: 'Reports' },
                { id: 'settings', icon: 'fas fa-cog', label: 'Settings' }
            ] : [
                { id: 'dashboard', icon: 'fas fa-tachometer-alt', label: 'Dashboard' },
                { id: 'upload', icon: 'fas fa-upload', label: 'Upload Image' },
                { id: 'schedule', icon: 'fas fa-calendar', label: 'Schedule' },
                { id: 'emergency', icon: 'fas fa-exclamation-circle', label: 'Emergency' },
                { id: 'reports', icon: 'fas fa-file-alt', label: 'My Reports' },
                { id: 'settings', icon: 'fas fa-cog', label: 'Settings' }
            ];

            return (
                <div className="sidebar w-64 h-screen fixed left-0 top-0 text-white p-6">
                    <div className="mb-8">
                        <h2 className="text-2xl font-bold">DeepInspect</h2>
                        <p className="text-blue-200 text-sm">{user.role} Portal</p>
                    </div>
                    
                    <nav className="space-y-2">
                        {menuItems.map(item => (
                            <button
                                key={item.id}
                                onClick={() => setCurrentView(item.id)}
                                className={`w-full flex items-center space-x-3 px-4 py-3 rounded-lg transition-colors ${
                                    currentView === item.id 
                                        ? 'bg-blue-600 text-white' 
                                        : 'text-blue-100 hover:bg-blue-700'
                                }`}
                            >
                                <i className={item.icon}></i>
                                <span>{item.label}</span>
                            </button>
                        ))}
                    </nav>
                    
                    <div className="absolute bottom-6 left-6 right-6">
                        <div className="bg-blue-800 rounded-lg p-4 mb-4">
                            <p className="text-sm text-blue-200">Logged in as:</p>
                            <p className="font-medium">{user.email}</p>
                        </div>
                        <button
                            onClick={onLogout}
                            className="w-full bg-red-600 hover:bg-red-700 text-white py-2 px-4 rounded-lg transition-colors"
                        >
                            <i className="fas fa-sign-out-alt mr-2"></i>
                            Logout
                        </button>
                    </div>
                </div>
            );
        }

        // Chart Components
        function DefectChart({ data }) {
            const chartRef = useRef(null);
            const chartInstance = useRef(null);

            useEffect(() => {
                if (chartInstance.current) {
                    chartInstance.current.destroy();
                }

                const ctx = chartRef.current.getContext('2d');
                chartInstance.current = new Chart(ctx, {
                    type: 'doughnut',
                    data: {
                        labels: ['Critical', 'High', 'Medium', 'Low'],
                        datasets: [{
                            data: [3, 7, 12, 8],
                            backgroundColor: ['#ef4444', '#f97316', '#eab308', '#22c55e'],
                            borderWidth: 0
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                position: 'bottom'
                            }
                        }
                    }
                });

                return () => {
                    if (chartInstance.current) {
                        chartInstance.current.destroy();
                    }
                };
            }, [data]);

            return <canvas ref={chartRef}></canvas>;
        }

        function TrendChart({ data }) {
            const chartRef = useRef(null);
            const chartInstance = useRef(null);

            useEffect(() => {
                if (chartInstance.current) {
                    chartInstance.current.destroy();
                }

                const ctx = chartRef.current.getContext('2d');
                chartInstance.current = new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
                        datasets: [{
                            label: 'Defects Found',
                            data: [5, 8, 3, 12, 7, 4],
                            borderColor: '#3b82f6',
                            backgroundColor: 'rgba(59, 130, 246, 0.1)',
                            tension: 0.4,
                            fill: true
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                display: false
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true
                            }
                        }
                    }
                });

                return () => {
                    if (chartInstance.current) {
                        chartInstance.current.destroy();
                    }
                };
            }, [data]);

            return <canvas ref={chartRef}></canvas>;
        }

        // Dashboard Components
        function InspectorDashboard({ user }) {
            const [inspections, setInspections] = useState([]);
            const [alerts, setAlerts] = useState(2);

            useEffect(() => {
                // Mock data loading
                setInspections([
                    { id: 1, tunnel: 'Tunnel A', date: '2024-01-15', defects: 3, severity: 'High' },
                    { id: 2, tunnel: 'Tunnel B', date: '2024-01-20', defects: 1, severity: 'Medium' },
                    { id: 3, tunnel: 'Tunnel C', date: '2024-01-25', defects: 5, severity: 'Critical' }
                ]);
            }, []);

            return (
                <div className="space-y-6">
                    <div className="flex justify-between items-center">
                        <h1 className="text-3xl font-bold text-blue-900">Inspector Dashboard</h1>
                        <div className="flex items-center space-x-4">
                            <div className="bg-red-100 text-red-800 px-3 py-1 rounded-full text-sm">
                                <i className="fas fa-bell mr-1"></i>
                                {alerts} Alerts
                            </div>
                        </div>
                    </div>

                    <div className="grid grid-cols-4 gap-6">
                        <div className="bg-white rounded-lg card-shadow p-6">
                            <div className="flex items-center">
                                <div className="p-3 bg-blue-100 rounded-full">
                                    <i className="fas fa-camera text-blue-600 text-xl"></i>
                                </div>
                                <div className="ml-4">
                                    <p className="text-gray-600 text-sm">Total Inspections</p>
                                    <p className="text-2xl font-bold text-blue-900">24</p>
                                </div>
                            </div>
                        </div>

                        <div className="bg-white rounded-lg card-shadow p-6">
                            <div className="flex items-center">
                                <div className="p-3 bg-orange-100 rounded-full">
                                    <i className="fas fa-exclamation-triangle text-orange-600 text-xl"></i>
                                </div>
                                <div className="ml-4">
                                    <p className="text-gray-600 text-sm">Defects Found</p>
                                    <p className="text-2xl font-bold text-orange-600">9</p>
                                </div>
                            </div>
                        </div>

                        <div className="bg-white rounded-lg card-shadow p-6">
                            <div className="flex items-center">
                                <div className="p-3 bg-green-100 rounded-full">
                                    <i className="fas fa-calendar-check text-green-600 text-xl"></i>
                                </div>
                                <div className="ml-4">
                                    <p className="text-gray-600 text-sm">Scheduled</p>
                                    <p className="text-2xl font-bold text-green-600">3</p>
                                </div>
                            </div>
                        </div>

                        <div className="bg-white rounded-lg card-shadow p-6">
                            <div className="flex items-center">
                                <div className="p-3 bg-red-100 rounded-full">
                                    <i className="fas fa-clock text-red-600 text-xl"></i>
                                </div>
                                <div className="ml-4">
                                    <p className="text-gray-600 text-sm">Overdue</p>
                                    <p className="text-2xl font-bold text-red-600">1</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div className="grid grid-cols-2 gap-6">
                        <div className="bg-white rounded-lg card-shadow p-6">
                            <h3 className="text-lg font-semibold text-blue-900 mb-4">Recent Inspections</h3>
                            <div className="space-y-3">
                                {inspections.map(inspection => (
                                    <div key={inspection.id} className="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                                        <div>
                                            <p className="font-medium">{inspection.tunnel}</p>
                                            <p className="text-sm text-gray-600">{inspection.date}</p>
                                        </div>
                                        <div className="text-right">
                                            <span className={`px-2 py-1 rounded-full text-xs ${
                                                inspection.severity === 'Critical' ? 'bg-red-100 text-red-800' :
                                                inspection.severity === 'High' ? 'bg-orange-100 text-orange-800' :
                                                'bg-yellow-100 text-yellow-800'
                                            }`}>
                                                {inspection.severity}
                                            </span>
                                            <p className="text-sm text-gray-600 mt-1">{inspection.defects} defects</p>
                                        </div>
                                    </div>
                                ))}
                            </div>
                        </div>

                        <div className="bg-white rounded-lg card-shadow p-6">
                            <h3 className="text-lg font-semibold text-blue-900 mb-4">Inspection Trends</h3>
                            <div className="chart-container">
                                <TrendChart data={[]} />
                            </div>
                        </div>
                    </div>

                    <div className="bg-white rounded-lg card-shadow p-6">
                        <h3 className="text-lg font-semibold text-blue-900 mb-4">Quick Actions</h3>
                        <div className="grid grid-cols-4 gap-4">
                            <button className="flex flex-col items-center p-4 bg-blue-50 rounded-lg hover:bg-blue-100 transition-colors">
                                <i className="fas fa-upload text-blue-600 text-2xl mb-2"></i>
                                <span className="text-sm font-medium">Upload Image</span>
                            </button>
                            <button className="flex flex-col items-center p-4 bg-green-50 rounded-lg hover:bg-green-100 transition-colors">
                                <i className="fas fa-calendar-plus text-green-600 text-2xl mb-2"></i>
                                <span className="text-sm font-medium">Schedule Inspection</span>
                            </button>
                            <button className="flex flex-col items-center p-4 bg-red-50 rounded-lg hover:bg-red-100 transition-colors">
                                <i className="fas fa-exclamation-circle text-red-600 text-2xl mb-2"></i>
                                <span className="text-sm font-medium">Emergency Alert</span>
                            </button>
                            <button className="flex flex-col items-center p-4 bg-purple-50 rounded-lg hover:bg-purple-100 transition-colors">
                                <i className="fas fa-file-download text-purple-600 text-2xl mb-2"></i>
                                <span className="text-sm font-medium">Generate Report</span>
                            </button>
                        </div>
                    </div>
                </div>
            );
        }

        function AdminDashboard({ user }) {
            const [emergencyAlerts, setEmergencyAlerts] = useState([
                { id: 1, inspector: 'John Doe', tunnel: 'Tunnel C', message: 'Critical structural damage detected', time: '2 minutes ago', urgent: true },
                { id: 2, inspector: 'Jane Smith', tunnel: 'Tunnel A', message: 'Water seepage increasing', time: '15 minutes ago', urgent: false }
            ]);
            
            const [totalInspectors, setTotalInspectors] = useState(12);
            const [totalInspections, setTotalInspections] = useState(156);
            const [criticalDefects, setCriticalDefects] = useState(8);
            const [pendingMaintenance, setPendingMaintenance] = useState(5);

            return (
                <div className="space-y-6">
                    <div className="flex justify-between items-center">
                        <h1 className="text-3xl font-bold text-blue-900">Administrator Dashboard</h1>
                        <div className="flex items-center space-x-4">
                            <div className="bg-red-100 text-red-800 px-3 py-1 rounded-full text-sm notification-badge">
                                <i className="fas fa-bell mr-1"></i>
                                {emergencyAlerts.filter(alert => alert.urgent).length} Urgent Alerts
                            </div>
                        </div>
                    </div>

                    <div className="grid grid-cols-4 gap-6">
                        <div className="bg-white rounded-lg card-shadow p-6">
                            <div className="flex items-center">
                                <div className="p-3 bg-blue-100 rounded-full">
                                    <i className="fas fa-users text-blue-600 text-xl"></i>
                                </div>
                                <div className="ml-4">
                                    <p className="text-gray-600 text-sm">Total Inspectors</p>
                                    <p className="text-2xl font-bold text-blue-900">{totalInspectors}</p>
                                </div>
                            </div>
                        </div>

                        <div className="bg-white rounded-lg card-shadow p-6">
                            <div className="flex items-center">
                                <div className="p-3 bg-green-100 rounded-full">
                                    <i className="fas fa-search text-green-600 text-xl"></i>
                                </div>
                                <div className="ml-4">
                                    <p className="text-gray-600 text-sm">Total Inspections</p>
                                    <p className="text-2xl font-bold text-green-600">{totalInspections}</p>
                                </div>
                            </div>
                        </div>

                        <div className="bg-white rounded-lg card-shadow p-6">
                            <div className="flex items-center">
                                <div className="p-3 bg-red-100 rounded-full">
                                    <i className="fas fa-exclamation-triangle text-red-600 text-xl"></i>
                                </div>
                                <div className="ml-4">
                                    <p className="text-gray-600 text-sm">Critical Defects</p>
                                    <p className="text-2xl font-bold text-red-600">{criticalDefects}</p>
                                </div>
                            </div>
                        </div>

                        <div className="bg-white rounded-lg card-shadow p-6">
                            <div className="flex items-center">
                                <div className="p-3 bg-orange-100 rounded-full">
                                    <i className="fas fa-wrench text-orange-600 text-xl"></i>
                                </div>
                                <div className="ml-4">
                                    <p className="text-gray-600 text-sm">Pending Maintenance</p>
                                    <p className="text-2xl font-bold text-orange-600">{pendingMaintenance}</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div className="grid grid-cols-3 gap-6">
                        <div className="bg-white rounded-lg card-shadow p-6">
                            <h3 className="text-lg font-semibold text-blue-900 mb-4">Emergency Alerts</h3>
                            <div className="space-y-3 max-h-64 overflow-y-auto">
                                {emergencyAlerts.map(alert => (
                                    <div key={alert.id} className={`p-3 rounded-lg border-l-4 ${
                                        alert.urgent ? 'bg-red-50 border-red-500' : 'bg-yellow-50 border-yellow-500'
                                    }`}>
                                        <div className="flex justify-between items-start">
                                            <div>
                                                <p className="font-medium text-sm">{alert.tunnel}</p>
                                                <p className="text-xs text-gray-600">{alert.inspector}</p>
                                                <p className="text-sm mt-1">{alert.message}</p>
                                            </div>
                                            <span className="text-xs text-gray-500">{alert.time}</span>
                                        </div>
                                    </div>
                                ))}
                            </div>
                        </div>

                        <div className="bg-white rounded-lg card-shadow p-6">
                            <h3 className="text-lg font-semibold text-blue-900 mb-4">Defect Distribution</h3>
                            <div className="chart-container">
                                <DefectChart data={[]} />
                            </div>
                        </div>

                        <div className="bg-white rounded-lg card-shadow p-6">
                            <h3 className="text-lg font-semibold text-blue-900 mb-4">System Status</h3>
                            <div className="space-y-4">
                                <div className="flex justify-between items-center">
                                    <span className="text-sm">ML Analysis Service</span>
                                    <span className="flex items-center text-green-600">
                                        <i className="fas fa-circle text-xs mr-2"></i>
                                        Online
                                    </span>
                                </div>
                                <div className="flex justify-between items-center">
                                    <span className="text-sm">Database</span>
                                    <span className="flex items-center text-green-600">
                                        <i className="fas fa-circle text-xs mr-2"></i>
                                        Connected
                                    </span>
                                </div>
                                <div className="flex justify-between items-center">
                                    <span className="text-sm">Storage</span>
                                    <span className="flex items-center text-green-600">
                                        <i className="fas fa-circle text-xs mr-2"></i>
                                        Available
                                    </span>
                                </div>
                                <div className="flex justify-between items-center">
                                    <span className="text-sm">Notifications</span>
                                    <span className="flex items-center text-yellow-600">
                                        <i className="fas fa-circle text-xs mr-2"></i>
                                        Limited
                                    </span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div className="grid grid-cols-2 gap-6">
                        <div className="bg-white rounded-lg card-shadow p-6">
                            <h3 className="text-lg font-semibold text-blue-900 mb-4">Recent Activity</h3>
                            <div className="space-y-3">
                                <div className="flex items-center space-x-3 p-2 bg-gray-50 rounded">
                                    <i className="fas fa-upload text-blue-600"></i>
                                    <div>
                                        <p className="text-sm font-medium">New inspection uploaded</p>
                                        <p className="text-xs text-gray-600">John Doe - Tunnel A - 5 minutes ago</p>
                                    </div>
                                </div>
                                <div className="flex items-center space-x-3 p-2 bg-gray-50 rounded">
                                    <i className="fas fa-exclamation-triangle text-red-600"></i>
                                    <div>
                                        <p className="text-sm font-medium">Critical defect detected</p>
                                        <p className="text-xs text-gray-600">ML Analysis - Tunnel C - 8 minutes ago</p>
                                    </div>
                                </div>
                                <div className="flex items-center space-x-3 p-2 bg-gray-50 rounded">
                                    <i className="fas fa-user-plus text-green-600"></i>
                                    <div>
                                        <p className="text-sm font-medium">New inspector registered</p>
                                        <p className="text-xs text-gray-600">Sarah Wilson - 12 minutes ago</p>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div className="bg-white rounded-lg card-shadow p-6">
                            <h3 className="text-lg font-semibold text-blue-900 mb-4">Maintenance Schedule</h3>
                            <div className="space-y-3">
                                <div className="flex justify-between items-center p-3 bg-blue-50 rounded-lg">
                                    <div>
                                        <p className="font-medium">Tunnel A - Section 2</p>
                                        <p className="text-sm text-gray-600">Crack repair scheduled</p>
                                    </div>
                                    <span className="text-sm text-blue-600">Today</span>
                                </div>
                                <div className="flex justify-between items-center p-3 bg-yellow-50 rounded-lg">
                                    <div>
                                        <p className="font-medium">Tunnel B - Section 5</p>
                                        <p className="text-sm text-gray-600">Water seepage fix</p>
                                    </div>
                                    <span className="text-sm text-yellow-600">Tomorrow</span>
                                </div>
                                <div className="flex justify-between items-center p-3 bg-red-50 rounded-lg">
                                    <div>
                                        <p className="font-medium">Tunnel C - Section 1</p>
                                        <p className="text-sm text-gray-600">Structural reinforcement</p>
                                    </div>
                                    <span className="text-sm text-red-600">Overdue</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            );
        }

        // Image Upload Component
        function ImageUpload({ user }) {
            const [selectedImage, setSelectedImage] = useState(null);
            const [previewUrl, setPreviewUrl] = useState('');
            const [analyzing, setAnalyzing] = useState(false);
            const [analysisResult, setAnalysisResult] = useState(null);
            const [uploadHistory, setUploadHistory] = useState([
                { id: 1, filename: 'tunnel_a_section1.jpg', date: '2024-01-15', defects: 'Crack', severity: 'High' },
                { id: 2, filename: 'tunnel_b_entrance.jpg', date: '2024-01-20', defects: 'Water Seepage', severity: 'Medium' },
                { id: 3, filename: 'tunnel_c_ceiling.jpg', date: '2024-01-25', defects: 'Structural Damage', severity: 'Critical' }
            ]);

            const handleImageUpload = (event) => {
                const file = event.target.files[0];
                if (file) {
                    setSelectedImage(file);
                    const reader = new FileReader();
                    reader.onload = (e) => setPreviewUrl(e.target.result);
                    reader.readAsDataURL(file);
                }
            };

            const handleAnalyze = async () => {
                if (!selectedImage) return;
                
                setAnalyzing(true);
                
                // Mock ML analysis
                setTimeout(() => {
                    const mockResults = [
                        { defectType: 'Crack', severity: 'High', confidence: 92, maintenanceDate: '2024-02-15' },
                        { defectType: 'Water Seepage', severity: 'Medium', confidence: 87, maintenanceDate: '2024-03-01' },
                        { defectType: 'Structural Damage', severity: 'Critical', confidence: 95, maintenanceDate: '2024-01-30' }
                    ];
                    
                    const result = mockResults[Math.floor(Math.random() * mockResults.length)];
                    setAnalysisResult(result);
                    setAnalyzing(false);
                    
                    // Add to history
                    const newEntry = {
                        id: Date.now(),
                        filename: selectedImage.name,
                        date: new Date().toISOString().split('T')[0],
                        defects: result.defectType,
                        severity: result.severity
                    };
                    setUploadHistory(prev => [newEntry, ...prev]);
                }, 3000);
            };

            return (
                <div className="space-y-6">
                    <h1 className="text-3xl font-bold text-blue-900">Upload Tunnel Image</h1>
                    
                    <div className="grid grid-cols-2 gap-6">
                        <div className="bg-white rounded-lg card-shadow p-6">
                            <h3 className="text-lg font-semibold text-blue-900 mb-4">Image Upload</h3>
                            
                            <div className="upload-zone rounded-lg p-8 text-center mb-4">
                                <input
                                    type="file"
                                    accept="image/*"
                                    onChange={handleImageUpload}
                                    className="hidden"
                                    id="imageUpload"
                                />
                                <label htmlFor="imageUpload" className="cursor-pointer">
                                    <i className="fas fa-cloud-upload-alt text-4xl text-blue-500 mb-4 block"></i>
                                    <p className="text-lg font-medium text-blue-900">Click to upload image</p>
                                    <p className="text-sm text-gray-600">JPG, PNG, or GIF up to 10MB</p>
                                </label>
                            </div>
                            
                            {previewUrl && (
                                <div>
                                    <img
                                        src={previewUrl}
                                        alt="Preview"
                                        className="w-full h-64 object-cover rounded-lg mb-4"
                                    />
                                    <button
                                        onClick={handleAnalyze}
                                        disabled={analyzing}
                                        className="w-full btn-primary text-white py-3 px-4 rounded-lg font-medium disabled:opacity-50"
                                    >
                                        {analyzing ? (
                                            <>
                                                <div className="loading-spinner mr-2 inline-block" style={{width: '20px', height: '20px'}}></div>
                                                Analyzing...
                                            </>
                                        ) : (
                                            <>
                                                <i className="fas fa-brain mr-2"></i>
                                                Run ML Analysis
                                            </>
                                        )}
                                    </button>
                                </div>
                            )}
                        </div>
                        
                        <div className="bg-white rounded-lg card-shadow p-6">
                            <h3 className="text-lg font-semibold text-blue-900 mb-4">Analysis Results</h3>
                            
                            {analysisResult ? (
                                <div className="space-y-4">
                                    <div className="p-4 bg-blue-50 rounded-lg">
                                        <h4 className="font-semibold text-blue-900">Defect Detected</h4>
                                        <p className="text-lg font-medium mt-1">{analysisResult.defectType}</p>
                                    </div>
                                    
                                    <div className="p-4 bg-orange-50 rounded-lg">
                                        <h4 className="font-semibold text-orange-900">Severity Level</h4>
                                        <p className={`text-lg font-medium mt-1 ${
                                            analysisResult.severity === 'Critical' ? 'text-red-600' :
                                            analysisResult.severity === 'High' ? 'text-orange-600' :
                                            'text-yellow-600'
                                        }`}>
                                            {analysisResult.severity}
                                        </p>
                                    </div>
                                    
                                    <div className="p-4 bg-green-50 rounded-lg">
                                        <h4 className="font-semibold text-green-900">Confidence</h4>
                                        <p className="text-lg font-medium mt-1">{analysisResult.confidence}%</p>
                                    </div>
                                    
                                    <div className="p-4 bg-yellow-50 rounded-lg">
                                        <h4 className="font-semibold text-yellow-900">Suggested Maintenance</h4>
                                        <p className="text-lg font-medium mt-1">{analysisResult.maintenanceDate}</p>
                                    </div>
                                </div>
                            ) : (
                                <div className="text-center text-gray-500 py-8">
                                    <i className="fas fa-chart-line text-4xl mb-4"></i>
                                    <p>Upload an image and run analysis to see results</p>
                                </div>
                            )}
                        </div>
                    </div>
                    
                    <div className="bg-white rounded-lg card-shadow p-6">
                        <h3 className="text-lg font-semibold text-blue-900 mb-4">Upload History</h3>
                        <div className="overflow-x-auto">
                            <table className="w-full">
                                <thead>
                                    <tr className="border-b">
                                        <th className="text-left py-3 px-4">Filename</th>
                                        <th className="text-left py-3 px-4">Date</th>
                                        <th className="text-left py-3 px-4">Defects Found</th>
                                        <th className="text-left py-3 px-4">Severity</th>
                                        <th className="text-left py-3 px-4">Actions</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {uploadHistory.map(item => (
                                        <tr key={item.id} className="border-b hover:bg-gray-50">
                                            <td className="py-3 px-4">{item.filename}</td>
                                            <td className="py-3 px-4">{item.date}</td>
                                            <td className="py-3 px-4">{item.defects}</td>
                                            <td className="py-3 px-4">
                                                <span className={`px-2 py-1 rounded-full text-xs ${
                                                    item.severity === 'Critical' ? 'bg-red-100 text-red-800' :
                                                    item.severity === 'High' ? 'bg-orange-100 text-orange-800' :
                                                    'bg-yellow-100 text-yellow-800'
                                                }`}>
                                                    {item.severity}
                                                </span>
                                            </td>
                                            <td className="py-3 px-4">
                                                <button className="text-blue-600 hover:text-blue-800 mr-2">
                                                    <i className="fas fa-eye"></i>
                                                </button>
                                                <button className="text-green-600 hover:text-green-800">
                                                    <i className="fas fa-download"></i>
                                                </button>
                                            </td>
                                        </tr>
                                    ))}
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            );
        }

        // Emergency Component
        function Emergency({ user }) {
            const [alertMessage, setAlertMessage] = useState('');
            const [alertSent, setAlertSent] = useState(false);
            const [alertHistory, setAlertHistory] = useState([
                { id: 1, message: 'Water flooding in Tunnel B Section 3', date: '2024-01-20', status: 'Resolved' },
                { id: 2, message: 'Structural crack widening in Tunnel A', date: '2024-01-18', status: 'In Progress' },
            ]);

            const sendEmergencyAlert = () => {
                if (!alertMessage.trim()) return;
                
                const newAlert = {
                    id: Date.now(),
                    message: alertMessage,
                    date: new Date().toISOString().split('T')[0],
                    status: 'Sent'
                };
                
                setAlertHistory(prev => [newAlert, ...prev]);
                setAlertMessage('');
                setAlertSent(true);
                
                setTimeout(() => setAlertSent(false), 3000);
            };

            return (
                <div className="space-y-6">
                    <h1 className="text-3xl font-bold text-blue-900">Emergency Alert System</h1>
                    
                    <div className="grid grid-cols-2 gap-6">
                        <div className="bg-white rounded-lg card-shadow p-6">
                            <h3 className="text-lg font-semibold text-red-600 mb-4">
                                <i className="fas fa-exclamation-triangle mr-2"></i>
                                Send Emergency Alert
                            </h3>
                            
                            <div className="space-y-4">
                                <div>
                                    <label className="block text-sm font-medium text-gray-700 mb-2">
                                        Emergency Description
                                    </label>
                                    <textarea
                                        value={alertMessage}
                                        onChange={(e) => setAlertMessage(e.target.value)}
                                        className="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-red-500"
                                        rows="4"
                                        placeholder="Describe the emergency situation..."
                                    />
                                </div>
                                
                                <button
                                    onClick={sendEmergencyAlert}
                                    disabled={!alertMessage.trim()}
                                    className="w-full emergency-alert text-white py-3 px-4 rounded-lg font-medium disabled:opacity-50 disabled:bg-gray-400"
                                >
                                    <i className="fas fa-exclamation-circle mr-2"></i>
                                    SEND EMERGENCY ALERT
                                </button>
                                
                                {alertSent && (
                                    <div className="bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded">
                                        <i className="fas fa-check-circle mr-2"></i>
                                        Emergency alert sent successfully!
                                    </div>
                                )}
                            </div>
                        </div>
                        
                        <div className="bg-white rounded-lg card-shadow p-6">
                            <h3 className="text-lg font-semibold text-blue-900 mb-4">Emergency Contacts</h3>
                            
                            <div className="space-y-3">
                                <div className="flex items-center justify-between p-3 bg-blue-50 rounded-lg">
                                    <div>
                                        <p className="font-medium">Control Center</p>
                                        <p className="text-sm text-gray-600">24/7 Emergency Response</p>
                                    </div>
                                    <button className="bg-blue-600 text-white px-3 py-1 rounded text-sm">
                                        <i className="fas fa-phone mr-1"></i>
                                        Call
                                    </button>
                                </div>
                                
                                <div className="flex items-center justify-between p-3 bg-red-50 rounded-lg">
                                    <div>
                                        <p className="font-medium">Safety Team</p>
                                        <p className="text-sm text-gray-600">Emergency Evacuation</p>
                                    </div>
                                    <button className="bg-red-600 text-white px-3 py-1 rounded text-sm">
                                        <i className="fas fa-phone mr-1"></i>
                                        Call
                                    </button>
                                </div>
                                
                                <div className="flex items-center justify-between p-3 bg-green-50 rounded-lg">
                                    <div>
                                        <p className="font-medium">Maintenance Team</p>
                                        <p className="text-sm text-gray-600">Technical Support</p>
                                    </div>
                                    <button className="bg-green-600 text-white px-3 py-1 rounded text-sm">
                                        <i className="fas fa-phone mr-1"></i>
                                        Call
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div className="bg-white rounded-lg card-shadow p-6">
                        <h3 className="text-lg font-semibold text-blue-900 mb-4">Alert History</h3>
                        
                        <div className="overflow-x-auto">
                            <table className="w-full">
                                <thead>
                                    <tr className="border-b">
                                        <th className="text-left py-3 px-4">Date</th>
                                        <th className="text-left py-3 px-4">Alert Message</th>
                                        <th className="text-left py-3 px-4">Status</th>
                                        <th className="text-left py-3 px-4">Actions</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {alertHistory.map(alert => (
                                        <tr key={alert.id} className="border-b hover:bg-gray-50">
                                            <td className="py-3 px-4">{alert.date}</td>
                                            <td className="py-3 px-4">{alert.message}</td>
                                            <td className="py-3 px-4">
                                                <span className={`px-2 py-1 rounded-full text-xs ${
                                                    alert.status === 'Resolved' ? 'bg-green-100 text-green-800' :
                                                    alert.status === 'In Progress' ? 'bg-yellow-100 text-yellow-800' :
                                                    'bg-blue-100 text-blue-800'
                                                }`}>
                                                    {alert.status}
                                                </span>
                                            </td>
                                            <td className="py-3 px-4">
                                                <button className="text-blue-600 hover:text-blue-800 mr-2">
                                                    <i className="fas fa-eye"></i>
                                                </button>
                                                <button className="text-green-600 hover:text-green-800">
                                                    <i className="fas fa-edit"></i>
                                                </button>
                                            </td>
                                        </tr>
                                    ))}
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            );
        }

        // Reports Component
        function Reports({ user }) {
            const [reportType, setReportType] = useState('inspection');
            const [dateRange, setDateRange] = useState('last30days');
            const [generating, setGenerating] = useState(false);

            const generateReport = () => {
                setGenerating(true);
                setTimeout(() => {
                    setGenerating(false);
                    // Mock download
                    alert('Report generated and downloaded successfully!');
                }, 2000);
            };

            return (
                <div className="space-y-6">
                    <h1 className="text-3xl font-bold text-blue-900">Reports & Analytics</h1>
                    
                    <div className="grid grid-cols-3 gap-6">
                        <div className="bg-white rounded-lg card-shadow p-6">
                            <h3 className="text-lg font-semibold text-blue-900 mb-4">Generate Report</h3>
                            
                            <div className="space-y-4">
                                <div>
                                    <label className="block text-sm font-medium text-gray-700 mb-2">Report Type</label>
                                    <select
                                        value={reportType}
                                        onChange={(e) => setReportType(e.target.value)}
                                        className="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                                    >
                                        <option value="inspection">Inspection Summary</option>
                                        <option value="defects">Defects Analysis</option>
                                        <option value="maintenance">Maintenance Log</option>
                                        <option value="billing">Billing Summary</option>
                                    </select>
                                </div>
                                
                                <div>
                                    <label className="block text-sm font-medium text-gray-700 mb-2">Date Range</label>
                                    <select
                                        value={dateRange}
                                        onChange={(e) => setDateRange(e.target.value)}
                                        className="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                                    >
                                        <option value="last7days">Last 7 Days</option>
                                        <option value="last30days">Last 30 Days</option>
                                        <option value="last3months">Last 3 Months</option>
                                        <option value="lastyear">Last Year</option>
                                    </select>
                                </div>
                                
                                <button
                                    onClick={generateReport}
                                    disabled={generating}
                                    className="w-full btn-primary text-white py-2 px-4 rounded-md disabled:opacity-50"
                                >
                                    {generating ? (
                                        <>
                                            <div className="loading-spinner mr-2 inline-block" style={{width: '16px', height: '16px'}}></div>
                                            Generating...
                                        </>
                                    ) : (
                                        <>
                                            <i className="fas fa-download mr-2"></i>
                                            Generate PDF
                                        </>
                                    )}
                                </button>
                            </div>
                        </div>
                        
                        <div className="bg-white rounded-lg card-shadow p-6">
                            <h3 className="text-lg font-semibold text-blue-900 mb-4">Quick Stats</h3>
                            <div className="space-y-3">
                                <div className="flex justify-between">
                                    <span className="text-gray-600">Total Inspections</span>
                                    <span className="font-semibold">156</span>
                                </div>
                                <div className="flex justify-between">
                                    <span className="text-gray-600">Defects Found</span>
                                    <span className="font-semibold text-orange-600">47</span>
                                </div>
                                <div className="flex justify-between">
                                    <span className="text-gray-600">Critical Issues</span>
                                    <span className="font-semibold text-red-600">8</span>
                                </div>
                                <div className="flex justify-between">
                                    <span className="text-gray-600">Resolved</span>
                                    <span className="font-semibold text-green-600">39</span>
                                </div>
                            </div>
                        </div>
                        
                        <div className="bg-white rounded-lg card-shadow p-6">
                            <h3 className="text-lg font-semibold text-blue-900 mb-4">Export Options</h3>
                            <div className="space-y-2">
                                <button className="w-full bg-red-600 text-white py-2 px-4 rounded-md hover:bg-red-700">
                                    <i className="fas fa-file-pdf mr-2"></i>
                                    Export as PDF
                                </button>
                                <button className="w-full bg-green-600 text-white py-2 px-4 rounded-md hover:bg-green-700">
                                    <i className="fas fa-file-excel mr-2"></i>
                                    Export as Excel
                                </button>
                                <button className="w-full bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700">
                                    <i className="fas fa-file-csv mr-2"></i>
                                    Export as CSV
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <div className="bg-white rounded-lg card-shadow p-6">
                        <h3 className="text-lg font-semibold text-blue-900 mb-4">Analytics Dashboard</h3>
                        
                        <div className="grid grid-cols-2 gap-6">
                            <div>
                                <h4 className="font-medium text-gray-700 mb-3">Defect Severity Distribution</h4>
                                <div className="chart-container">
                                    <DefectChart data={[]} />
                                </div>
                            </div>
                            
                            <div>
                                <h4 className="font-medium text-gray-700 mb-3">Inspection Trends</h4>
                                <div className="chart-container">
                                    <TrendChart data={[]} />
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div className="bg-white rounded-lg card-shadow p-6">
                        <h3 className="text-lg font-semibold text-blue-900 mb-4">Recent Reports</h3>
                        <div className="overflow-x-auto">
                            <table className="w-full">
                                <thead>
                                    <tr className="border-b">
                                        <th className="text-left py-3 px-4">Report Name</th>
                                        <th className="text-left py-3 px-4">Type</th>
                                        <th className="text-left py-3 px-4">Generated</th>
                                        <th className="text-left py-3 px-4">Size</th>
                                        <th className="text-left py-3 px-4">Actions</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr className="border-b hover:bg-gray-50">
                                        <td className="py-3 px-4">January Inspection Summary</td>
                                        <td className="py-3 px-4">PDF</td>
                                        <td className="py-3 px-4">2024-01-25</td>
                                        <td className="py-3 px-4">2.3 MB</td>
                                        <td className="py-3 px-4">
                                            <button className="text-blue-600 hover:text-blue-800 mr-2">
                                                <i className="fas fa-download"></i>
                                            </button>
                                            <button className="text-red-600 hover:text-red-800">
                                                <i className="fas fa-trash"></i>
                                            </button>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            );
        }

        // Main App Component
        function App() {
            const [user, setUser] = useState(null);
            const [currentView, setCurrentView] = useState('dashboard');

            const handleLogin = (userData) => {
                setUser(userData);
            };

            const handleLogout = async () => {
                await mockAuth.signOut();
                setUser(null);
                setCurrentView('dashboard');
            };

            const renderContent = () => {
                if (!user) return null;

                switch (currentView) {
                    case 'dashboard':
                        return user.role === 'Admin' ? 
                            <AdminDashboard user={user} /> : 
                            <InspectorDashboard user={user} />;
                    case 'upload':
                        return <ImageUpload user={user} />;
                    case 'emergency':
                        return <Emergency user={user} />;
                    case 'reports':
                        return <Reports user={user} />;
                    default:
                        return <div className="text-center py-12">
                            <i className="fas fa-cog text-4xl text-gray-400 mb-4"></i>
                            <p className="text-gray-600">This section is under development</p>
                        </div>;
                }
            };

            if (!user) {
                return <AuthComponent onLogin={handleLogin} />;
            }

            return (
                <div className="min-h-screen bg-gray-100">
                    <Sidebar 
                        user={user} 
                        currentView={currentView} 
                        setCurrentView={setCurrentView}
                        onLogout={handleLogout}
                    />
                    <main className="ml-64 p-6">
                        {renderContent()}
                    </main>
                </div>
            );
        }

        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>
